<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, width=device-width">
  <meta name="author" content="yaelahan, github.com/yaelahan">
  <title>Get Provinsi, Kabupaten/Kota, Kecamatan, Kelurahan/Desa with AJAX</title>
  <link rel="stylesheet" href="assets/css/bootstrap.min.css">
</head>

<body class="mt-5">

  <div class="col-md-6 offset-md-3">
    <div class="card">

      <div class="card-header">
        Get Provinsi, Kabupaten/Kota, Kecamatan, Kelurahan/Desa with AJAX
      </div>

      <div class="card-body">

        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Propinsi</label>
          <div class="col-sm-10">
            <select id="propinsi" class="form-control selectpicker" title="-- Pilih --"></select>
          </div>
        </div>

        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Kabupaten</label>
          <div class="col-sm-10">
            <select id="kabupaten" class="form-control selectpicker" title="-- Pilih --"></select>
          </div>
        </div>

        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Kecamatan</label>
          <div class="col-sm-10">
            <select id="kecamatan" class="form-control selectpicker" title="-- Pilih --"></select>
          </div>
        </div>

        <div class="form-group row">
          <label class="col-sm-2 col-form-label">Kelurahan</label>
          <div class="col-sm-10">
            <select id="kelurahan" class="form-control selectpicker" title="-- Pilih --"></select>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script src="assets/js/jquery-3.0.0.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    $(document).ready(function(){

      function getData(type,id = ''){
        var data = '<option hidden>-- Pilih --</option>',
            url = "assets/data-indonesia/",
            i;

        if(type === 'propinsi'){
          url += type + ".json";
        }else{
          url += type + "/" + id + ".json";
        }

        $.ajax({
          method: 'GET',
          url: url,
          dataType: "json",
          success: function(result){
            for(i=0; i < result.length; i++){
              data += '<option value="' + result[i]['id'] + '">' + result[i]['nama'] + '</option>';
            };
            $('#' + type).html(data);
          }
        });
      };

      //get propinsi when document ready
      getData('propinsi');

      //get kabupaten when provinsi selected
      $('#propinsi').on('change', function(){
        getData('kabupaten', $(this).val());
      });

      //get kecamatan when kabupaten selected
      $('#kabupaten').on('change', function(){
        getData('kecamatan', $(this).val());
      });

      //get kecamatan when kabupaten selected
      $('#kecamatan').on('change', function(){
        getData('kelurahan', $(this).val());
      })

    });
  </script>
</body>

</html>
